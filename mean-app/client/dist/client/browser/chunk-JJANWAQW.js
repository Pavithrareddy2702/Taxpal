import{a as U,b as M,c as A,d as z,g as j,i as H,l as $,m as B,n as G,o as q,q as L,s as R}from"./chunk-SWTIH3DO.js";import{a as Y}from"./chunk-L6XRWYET.js";import{a as V,b as N}from"./chunk-Q5QP427L.js";import{$ as k,Ab as r,Bb as y,Fb as _,Hb as m,Ib as c,Kc as I,Lc as D,Oc as F,Sa as l,Sc as T,Ub as h,Wb as s,X as O,Xb as v,Yb as w,bb as x,ga as d,gc as E,ha as g,hb as P,hc as S,lb as f,yb as p,zb as o}from"./chunk-24VTUSTZ.js";var b=class i{constructor(t){this.http=t}apiUrl=`${Y.apiUrl}/categories`;getAuthHeaders(){let t=localStorage.getItem("token");return{headers:new V({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}}getCategories(){return this.http.get(this.apiUrl,this.getAuthHeaders())}addCategory(t){return this.http.post(this.apiUrl,t,this.getAuthHeaders())}updateCategory(t,e){return this.http.put(`${this.apiUrl}/${t}`,e,this.getAuthHeaders())}deleteCategory(t){return this.http.delete(`${this.apiUrl}/${t}`,this.getAuthHeaders())}static \u0275fac=function(e){return new(e||i)(k(N))};static \u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"})};function W(i,t){i&1&&(o(0,"span",25),s(1,"Default"),r())}function X(i,t){if(i&1){let e=_();o(0,"li")(1,"div",18),y(2,"span",19),o(3,"span",20),s(4),r(),f(5,W,2,0,"span",21),r(),o(6,"div",22)(7,"button",23),m("click",function(){let a=d(e).$implicit,C=c(2);return g(C.editCategory(a))}),s(8," \u270E "),r(),o(9,"button",24),m("click",function(){let a=d(e).$implicit,C=c(2);return g(C.showDeleteConfirm(a))}),s(10," \u{1F5D1}\uFE0F "),r()()()}if(i&2){let e=t.$implicit;l(4),v(e.name),l(),p("ngIf",!e._id),l(2),p("disabled",!e._id)("title",e._id?"Edit":"Default categories cannot be edited"),l(2),p("disabled",!e._id)("title",e._id?"Delete":"Default categories cannot be deleted")}}function Z(i,t){i&1&&(o(0,"div",26),s(1," Category name required "),r())}function ee(i,t){if(i&1&&(o(0,"div",26),s(1),E(2,"titlecase"),r()),i&2){let e=c(2);l(),w(" Category already exists for ",S(2,1,e.categoryForm.value.type)," ")}}function te(i,t){if(i&1){let e=_();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2"),s(4,"Category Management"),r(),o(5,"button",4),m("click",function(){d(e);let a=c();return g(a.closeModal())}),s(6,"\xD7"),r()(),o(7,"div",5)(8,"button",6),m("click",function(){d(e);let a=c();return g(a.setTab("Expense"))}),s(9,"\u2212 Expense"),r(),o(10,"button",6),m("click",function(){d(e);let a=c();return g(a.setTab("Income"))}),s(11,"+ Income"),r()(),o(12,"ul",7),f(13,X,11,6,"li",8),r(),o(14,"form",9),m("ngSubmit",function(){d(e);let a=c();return g(a.addOrUpdateCategory())}),y(15,"input",10),f(16,Z,2,0,"div",11)(17,ee,3,3,"div",11),o(18,"select",12)(19,"option",13),s(20,"Income"),r(),o(21,"option",14),s(22,"Expense"),r()(),o(23,"div",15)(24,"button",16),m("click",function(){d(e);let a=c();return g(a.closeModal())}),s(25,"Cancel"),r(),o(26,"button",17),s(27),r()()()()()}if(i&2){let e,n=c();l(8),h("active",n.selectedTab==="Expense"),l(2),h("active",n.selectedTab==="Income"),l(3),p("ngForOf",n.displayedCategories),l(),p("formGroup",n.categoryForm),l(2),p("ngIf",((e=n.categoryForm.get("name"))==null?null:e.touched)&&((e=n.categoryForm.get("name"))==null?null:e.hasError("required"))),l(),p("ngIf",n.categoryForm.hasError("duplicate")),l(10),v(n.editingCategory?"Update":"Add")}}function ie(i,t){if(i&1){let e=_();o(0,"div",1)(1,"div",2)(2,"p"),s(3),r(),o(4,"div",15)(5,"button",27),m("click",function(){d(e);let a=c();return g(a.confirmDelete())}),s(6,"Yes"),r(),o(7,"button",28),m("click",function(){d(e);let a=c();return g(a.cancelDelete())}),s(8,"Cancel"),r()()()()}if(i&2){let e=c();l(3),w('Are you sure you want to delete "',e.confirmDeleteCategory.name,'"?')}}var J=class i{constructor(t,e){this.fb=t;this.categoryService=e;this.categoryForm=this.fb.group({name:["",M.required],type:["income",M.required]})}open=!1;showModal=!1;selectedTab="Expense";defaultCategories=[{name:"Salary",type:"income"},{name:"Freelancing",type:"income"},{name:"Investments",type:"income"},{name:"Rental Income",type:"income"},{name:"Business Profit",type:"income"},{name:"Rent",type:"expense"},{name:"Utilities",type:"expense"},{name:"Groceries",type:"expense"},{name:"Transportation",type:"expense"},{name:"Entertainment",type:"expense"}];userCategories=[];displayedCategories=[];categoryForm;editingCategory=null;confirmDeleteCategory=null;ngOnInit(){this.openModal(),this.loadUserCategories()}loadUserCategories(){this.categoryService.getCategories().subscribe({next:t=>{this.userCategories=t.data,this.filterCategories()},error:t=>console.error("Error loading categories:",t)})}filterCategories(){let t=this.selectedTab.toLowerCase();this.displayedCategories=[...this.defaultCategories,...this.userCategories].filter(e=>e.type===t)}setTab(t){this.selectedTab=t,this.filterCategories()}openModal(){this.showModal=!0}closeModal(){this.showModal=!1,this.editingCategory=null,this.categoryForm.reset({type:"income"}),this.categoryForm.setErrors(null)}addOrUpdateCategory(){if(this.categoryForm.invalid){this.categoryForm.markAllAsTouched();return}let{name:t,type:e}=this.categoryForm.value,n=t.trim().toLowerCase();if([...this.defaultCategories,...this.userCategories].find(u=>u.type===e&&u.name.toLowerCase()===n&&u!==this.editingCategory)){this.categoryForm.setErrors({duplicate:!0});return}this.editingCategory&&this.editingCategory._id?this.categoryService.updateCategory(this.editingCategory._id,{name:t,type:e}).subscribe({next:()=>this.loadUserCategories(),error:u=>console.error("Error updating category:",u)}):this.categoryService.addCategory({name:t,type:e}).subscribe({next:()=>this.loadUserCategories(),error:u=>console.error("Error adding category:",u)}),this.closeModal()}editCategory(t){t._id&&(this.editingCategory=t,this.categoryForm.setValue({name:t.name,type:t.type}),this.openModal())}showDeleteConfirm(t){t._id&&(this.confirmDeleteCategory=t)}cancelDelete(){this.confirmDeleteCategory=null}confirmDelete(){this.confirmDeleteCategory&&this.confirmDeleteCategory._id&&this.categoryService.deleteCategory(this.confirmDeleteCategory._id).subscribe({next:()=>this.loadUserCategories(),error:t=>console.error("Error deleting category:",t)}),this.confirmDeleteCategory=null}static \u0275fac=function(e){return new(e||i)(x(L),x(b))};static \u0275cmp=P({type:i,selectors:[["app-categories"]],inputs:{open:"open"},decls:2,vars:2,consts:[["class","modal-overlay",4,"ngIf"],[1,"modal-overlay"],[1,"modal-content"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"tabs"],[3,"click"],[1,"category-list"],[4,"ngFor","ngForOf"],[1,"category-form",3,"ngSubmit","formGroup"],["formControlName","name","placeholder","Category Name"],["class","error",4,"ngIf"],["formControlName","type"],["value","income"],["value","expense"],[1,"form-buttons"],["type","button",1,"cancel-btn",3,"click"],["type","submit",1,"add-btn"],[1,"cat-info"],[1,"dot"],[1,"cat-name"],["class","default-badge",4,"ngIf"],[1,"actions"],[1,"edit-btn",3,"click","disabled","title"],[1,"delete-btn",3,"click","disabled","title"],[1,"default-badge"],[1,"error"],[1,"add-btn",3,"click"],[1,"cancel-btn",3,"click"]],template:function(e,n){e&1&&f(0,te,28,9,"div",0)(1,ie,9,1,"div",0),e&2&&(p("ngIf",n.showModal),l(),p("ngIf",n.confirmDeleteCategory))},dependencies:[T,I,D,R,j,G,q,U,B,A,z,H,$,F],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000047;display:flex;justify-content:center;align-items:center;z-index:1000;padding:16px;box-sizing:border-box}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:600px;max-width:90%;max-height:85vh;padding:25px 30px;box-shadow:0 15px 25px #0003;display:flex;flex-direction:column;overflow-y:auto;box-sizing:border-box}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:teal;font-size:clamp(18px,2.5vw,22px)}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#888;transition:.2s}.close-btn[_ngcontent-%COMP%]:hover{color:teal}.tabs[_ngcontent-%COMP%]{display:flex;margin-bottom:15px;border-bottom:2px solid #f0f0f0}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;background:none;border:none;padding:10px 0;font-weight:600;color:#666;cursor:pointer;gap:6px;font-size:clamp(14px,2.5vw,16px);display:flex;justify-content:center;align-items:center}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:teal;border-bottom:3px solid #00a676}.tab-symbol[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.category-list[_ngcontent-%COMP%]{list-style:none;margin:0 0 20px;padding:0;max-height:250px;overflow-y:auto;border-top:1px solid #eee;border-bottom:1px solid #eee}.category-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid #f5f5f5}.cat-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.cat-name[_ngcontent-%COMP%]{font-weight:500}.dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;background:#00a676}.category-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.category-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#00a676;border-radius:6px}.category-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f0f0f0}.actions[_ngcontent-%COMP%]{display:flex;gap:10px}.edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;font-size:16px;transition:.2s}.edit-btn[_ngcontent-%COMP%]:hover{color:teal}.delete-btn[_ngcontent-%COMP%]:hover{color:#e74c3c}.category-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .category-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:12px;margin-bottom:12px;border-radius:8px;border:1px solid #ccc;font-size:14px;box-sizing:border-box}.form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px}.add-btn[_ngcontent-%COMP%]{background:#00a676;color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:600}.add-btn[_ngcontent-%COMP%]:hover{background:#008060}.cancel-btn[_ngcontent-%COMP%]{background:#f0f0f0;color:#555;border:none;padding:10px 16px;border-radius:8px;cursor:pointer}.cancel-btn[_ngcontent-%COMP%]:hover{background:#e0e0e0}.error[_ngcontent-%COMP%]{color:#ff4d4f;font-size:.875rem;margin:4px 0 8px}input.ng-touched.ng-invalid[_ngcontent-%COMP%]{border:1px solid #ff4d4f}"]})};export{J as Categories};
